<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackTechnology - Business Suite</title>
    <style>
        /* COLORES HACKTECHNOLOGY: DARK & NEON */
        :root { 
            --dark-bg: #0d1117; 
            --card-bg: #161b22;
            --neon-green: #2ebc4f; 
            --neon-blue: #58a6ff;
            --text-main: #c9d1d9;
            --red: #f85149;
        }

        body { 
            font-family: 'Segoe UI', Roboto, sans-serif; 
            background: var(--dark-bg); 
            margin: 0; padding: 0; 
            color: var(--text-main); 
        }
        
        /* PANTALLA DE ACTIVACI√ìN */
        #activation-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: radial-gradient(circle, #161b22 0%, #0d1117 100%); 
            display: flex; align-items: center; justify-content: center; z-index: 9999; 
        }
        .activation-box { 
            background: var(--card-bg); padding: 40px 30px; border-radius: 20px; 
            width: 85%; max-width: 380px; text-align: center; 
            box-shadow: 0 0 20px rgba(46, 188, 79, 0.2); border: 1px solid #30363d;
        }
        .logo-ht { 
            background: var(--neon-green); color: #000; width: 70px; height: 70px; 
            line-height: 70px; border-radius: 18px; font-weight: 900; font-size: 28px; 
            margin: 0 auto 20px; box-shadow: 0 0 15px var(--neon-green);
        }

        /* NAVEGACI√ìN ESTILO TECH */
        .navbar { 
            display: none; background: var(--card-bg); border-bottom: 1px solid #30363d; 
            position: sticky; top: 0; z-index: 1000; justify-content: space-around; 
        }
        .tab-btn { 
            flex: 1; padding: 15px 5px; border: none; background: none; 
            font-weight: bold; color: #8b949e; cursor: pointer; font-size: 0.8rem;
            display: flex; flex-direction: column; align-items: center; gap: 5px; 
        }
        .tab-btn.active { color: var(--neon-green); border-bottom: 3px solid var(--neon-green); }

        /* M√ìDULOS */
        .module { display: none; padding: 15px; animation: fadeIn 0.4s ease; }
        .module.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .card { 
            background: var(--card-bg); padding: 20px; border-radius: 15px; 
            margin-bottom: 15px; border: 1px solid #30363d;
        }
        h3 { margin: 0 0 15px 0; font-size: 1rem; color: var(--neon-blue); text-transform: uppercase; letter-spacing: 1px; }
        
        /* FORMULARIOS */
        input, select { 
            width: 100%; padding: 14px; border: 1px solid #30363d; border-radius: 10px; 
            box-sizing: border-box; font-size: 16px; margin-bottom: 12px; 
            background: #0d1117; color: white; outline: none;
        }
        input:focus { border-color: var(--neon-green); }

        /* BOTONES */
        .btn { 
            border: none; padding: 15px; width: 100%; border-radius: 10px; 
            font-size: 16px; font-weight: bold; cursor: pointer; 
            display: flex; align-items: center; justify-content: center; gap: 10px; 
        }
        .btn-green { background: var(--neon-green); color: #0d1117; }
        .btn-blue { background: var(--neon-blue); color: #0d1117; }
        .btn-vaciar { 
            background: transparent; color: var(--red); border: 1px solid var(--red); 
            width: auto; padding: 8px 15px; font-size: 12px; margin-left: auto;
        }
        
        /* RESULTADOS */
        .item-row { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 12px 0; border-bottom: 1px solid #21262d; 
        }
        .monto-total { font-size: 2.5rem; font-weight: bold; color: var(--neon-green); display: block; }
        .vuelto-box { 
            background: rgba(46, 188, 79, 0.1); padding: 20px; border-radius: 15px; 
            border: 1px solid var(--neon-green); text-align: center; 
        }
        .id-display { background: #000; color: var(--neon-green); padding: 12px; border-radius: 8px; font-family: monospace; border: 1px solid #30363d; margin: 10px 0; }
    </style>
</head>
<body>

    <div id="activation-screen">
        <div class="activation-box">
            <div class="logo-ht">HT</div>
            <h1 style="font-size: 22px; margin: 0; color: white;">HackTechnology</h1>
            <p style="color: var(--neon-blue); font-size: 13px; margin-bottom: 20px;">SECURITY ACTIVATION SYSTEM</p>
            
            <div style="text-align:left; font-size: 11px; color:#8b949e;">DEVICE ID:</div>
            <div id="displayID" class="id-display">...</div>
            
            <input type="text" id="inputLicencia" placeholder="Introducir Licencia Pro">
            <button class="btn btn-green" onclick="verificarLicencia()">DESBLOQUEAR SISTEMA</button>
            
            <p style="margin-top:25px; font-size: 12px; color: #8b949e;">Technical Support:<br><b>+58 426-0869376</b></p>
        </div>
    </div>

    <nav class="navbar" id="main-nav">
        <button class="tab-btn active" onclick="switchTab(event, 'mod-inv')">‚öôÔ∏è<span>Inventario</span></button>
        <button class="tab-btn" onclick="switchTab(event, 'mod-vta')">üõí<span>Ventas</span></button>
        <button class="tab-btn" onclick="switchTab(event, 'mod-caja')">üíµ<span>Caja</span></button>
    </nav>

    <div id="mod-inv" class="module">
        <div class="card">
            <h3>Tasa BCV (D√≥lar)</h3>
            <div style="display:flex; gap:10px;">
                <input type="number" id="tasaInput" value="39.87" step="0.0001">
                <button class="btn btn-blue" style="width:auto; padding: 0 20px;" onclick="obtenerTasa()">üîÑ</button>
            </div>
            <small style="color:var(--neon-green)">‚óè Base de Datos HackTechnology Conectada</small>
        </div>
        <div class="card">
            <h3>Gesti√≥n de Productos</h3>
            <input type="hidden" id="editIndex" value="-1">
            <input type="text" id="invNombre" placeholder="Nombre del Producto">
            <div style="display:flex; gap:10px;">
                <input type="number" id="invCosto" placeholder="Costo $">
                <input type="number" id="invUnd" placeholder="Unidades">
            </div>
            <input type="number" id="invMargen" value="30">
            <button class="btn btn-blue" id="btnGuardar" onclick="guardarProducto()">üíæ GUARDAR PRODUCTO</button>
            <div id="lista-inventario" style="margin-top:20px;"></div>
        </div>
    </div>

    <div id="mod-vta" class="module active">
        <div class="card" style="border-top: 4px solid var(--neon-green);">
            <h3>Punto de Venta</h3>
            <select id="select-prod" onchange="preview()"></select>
            <div id="preview-box" style="display:none; background:rgba(88, 166, 255, 0.1); padding:12px; border-radius:10px; margin-bottom:12px; color:var(--neon-blue); border:1px solid var(--neon-blue);"></div>
            <input type="number" id="vtaCant" value="1">
            <button class="btn btn-green" onclick="alCarrito()">‚ûï REGISTRAR ITEM</button>
        </div>
        <div id="carrito-lista" style="padding:10px;"></div>
        <button class="btn btn-vaciar" onclick="vaciarVenta()">üóëÔ∏è VACIAR VENTA</button>
    </div>

    <div id="mod-caja" class="module">
        <div class="card">
            <h3>Resumen Final</h3>
            <span class="monto-total" id="totalBs">0,00 Bs</span>
            <span id="totalUsd" style="color:var(--neon-blue); font-weight:bold;">(0,00 $)</span>
        </div>
        <div class="card">
            <h3>C√°lculo de Vuelto</h3>
            <input type="number" id="pagoBs" placeholder="Bol√≠vares Recibidos" oninput="vuelto()">
            <div class="vuelto-box">
                <small style="color:white">VUELTO CORRESPONDIENTE:</small><br>
                <strong id="vBs" style="font-size: 2.2rem; color: var(--neon-green);">0,00</strong> <span style="color:var(--neon-green)">Bs</span>
            </div>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button class="btn btn-blue" onclick="window.print()">üñ®Ô∏è TICKET</button>
                <button class="btn btn-green" onclick="enviarWA()">üì± WHATSAPP</button>
            </div>
            <button class="btn" style="background:none; color:#444; margin-top:30px; font-size:12px;" onclick="location.reload()">üîí BLOQUEAR TERMINAL</button>
        </div>
    </div>

    <script>
        let inventario = JSON.parse(localStorage.getItem('ht_inv')) || [];
        let carrito = [];
        const fm = (n) => new Intl.NumberFormat('es-VE', { minimumFractionDigits: 2 }).format(n);

        // --- SISTEMA DE LLAVES HT ---
        const getID = () => "HT-" + (navigator.userAgent.length + screen.width) + "-" + (screen.height % 9);
        const myID = getID();
        document.getElementById('displayID').innerText = myID;

        function verificarLicencia() {
            const lic = document.getElementById('inputLicencia').value.trim();
            const correcta = "PRO-" + myID.split('').reverse().join('') + "-X" + (myID.length * 7);
            if(lic === correcta) {
                localStorage.setItem('ht_active', lic);
                location.reload();
            } else { alert("ACCESO DENEGADO: Licencia Inv√°lida."); }
        }

        window.onload = () => {
            const activa = localStorage.getItem('ht_active');
            const correcta = "PRO-" + myID.split('').reverse().join('') + "-X" + (myID.length * 7);
            if(activa === correcta) {
                document.getElementById('activation-screen').style.display = 'none';
                document.getElementById('main-nav').style.display = 'flex';
                actualizarInterfaz();
                obtenerTasa();
            }
        };

        // --- L√ìGICA DE NEGOCIO ---
        function switchTab(e, id) {
            document.querySelectorAll('.module').forEach(m => m.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            e.currentTarget.classList.add('active');
        }

        function obtenerTasa() {
            fetch('https://ve.dolarapi.com/v1/dolares/oficial').then(r => r.json()).then(d => {
                if(d.promedio) document.getElementById('tasaInput').value = parseFloat(d.promedio).toFixed(4);
            });
        }

        function guardarProducto() {
            let n = document.getElementById('invNombre').value;
            let c = parseFloat(document.getElementById('invCosto').value);
            let u = parseInt(document.getElementById('invUnd').value);
            let m = (parseFloat(document.getElementById('invMargen').value)/100)+1;
            let idx = parseInt(document.getElementById('editIndex').value);
            if(!n || isNaN(c)) return;

            let pData = { nombre: n, precioD: (c/u)*m, costo: c, und: u, margen: document.getElementById('invMargen').value };
            if(idx === -1) inventario.push(pData); else inventario[idx] = pData;
            
            localStorage.setItem('ht_inv', JSON.stringify(inventario));
            actualizarInterfaz();
            limpiar();
        }

        function actualizarInterfaz() {
            let h = ""; let o = "<option value=''>-- SELECCIONAR PRODUCTO --</option>";
            inventario.forEach((p, i) => {
                h += `<div class='item-row'><span><b>${p.nombre}</b></span><div>
                    <button onclick='editar(${i})' style='border:none; background:none; color:var(--neon-blue); margin-right:15px; cursor:pointer;'>‚úèÔ∏è</button>
                    <button onclick='eliminar(${i})' style='border:none; background:none; color:var(--red); cursor:pointer;'>‚úï</button>
                </div></div>`;
                o += `<option value='${i}'>${p.nombre}</option>`;
            });
            document.getElementById('lista-inventario').innerHTML = h;
            document.getElementById('select-prod').innerHTML = o;
        }

        function preview() {
            let idx = document.getElementById('select-prod').value;
            let t = parseFloat(document.getElementById('tasaInput').value);
            let box = document.getElementById('preview-box');
            if(idx!=="") {
                let p = inventario[idx];
                box.style.display = "block";
                box.innerHTML = `PRECIO UNITARIO: ${fm(p.precioD)}$ / ${fm(p.precioD * t)} Bs`;
            } else box.style.display = "none";
        }

        function alCarrito() {
            let idx = document.getElementById('select-prod').value;
            let cant = parseFloat(document.getElementById('vtaCant').value);
            let t = parseFloat(document.getElementById('tasaInput').value);
            if(idx==="") return;
            let p = inventario[idx];
            carrito.push({ nombre: p.nombre, cant, subtotal: p.precioD * cant * t });
            renderCarrito();
        }

        function renderCarrito() {
            let h = ""; let tot = 0;
            let t = parseFloat(document.getElementById('tasaInput').value);
            carrito.forEach((item, i) => {
                tot += item.subtotal;
                h += `<div class='item-row'><span>${item.cant}x ${item.nombre}</span><span>${fm(item.subtotal)} Bs</span></div>`;
            });
            document.getElementById('carrito-lista').innerHTML = h;
            document.getElementById('totalBs').innerText = fm(tot) + " Bs";
            document.getElementById('totalUsd').innerText = "(" + fm(tot/t) + " $)";
            vuelto();
        }

        function vuelto() {
            let t = parseFloat(document.getElementById('totalBs').innerText.replace(/\./g,'').replace(',','.'));
            let p = parseFloat(document.getElementById('pagoBs').value) || 0;
            document.getElementById('vBs').innerText = fm(p - t);
        }

        function eliminar(i) { if(confirm("¬øEliminar item?")) { inventario.splice(i,1); localStorage.setItem('ht_inv', JSON.stringify(inventario)); actualizarInterfaz(); } }
        function editar(i) {
            let p = inventario[i];
            document.getElementById('invNombre').value = p.nombre;
            document.getElementById('invCosto').value = p.costo;
            document.getElementById('invUnd').value = p.und;
            document.getElementById('editIndex').value = i;
            switchTab(null, 'mod-inv');
        }
        function vaciarVenta() { if(confirm("¬øVaciar todo el carrito?")) { carrito = []; renderCarrito(); } }
        function limpiar() { document.getElementById('invNombre').value = ""; document.getElementById('editIndex').value = "-1"; }
        function enviarWA() {
            let t = document.getElementById('totalBs').innerText;
            let items = carrito.map(i => `- ${i.cant} ${i.nombre}`).join('%0A');
            let msg = `üé´ *HACKTECHNOLOGY POS*%0A%0A${items}%0A%0A*TOTAL:* ${t}`;
            window.open(`https://wa.me/?text=${msg}`, '_blank');
        }
    </script>
</body>
</html>
